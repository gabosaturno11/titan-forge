<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Saturno Bonus Vault - Interactive Tools</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Outfit:wght@100..900&display=swap" rel="stylesheet">

<style>
  :root {
    --bg-deep: #000000;
    --bg-mid: #0a0a0a;
    --bg-card: #111111;
    --bg-hover: #1a1a1a;
    --border: #222222;
    --border-hover: #333333;
    --text-primary: #ffffff;
    --text-secondary: #888888;
    --text-muted: #555555;
    --accent: #6c3aff;
    --accent-dim: #6c3aff80;
    --accent-subtle: #6c3aff20;
    --success: #00ff00;
    --warning: #ffff00;
    --danger: #ff0000;
    --font-display: 'JetBrains Mono', monospace;
    --font-mono: 'JetBrains Mono', monospace;
  }

  /* ═══ EDIT MODE ═══ */
  .edit-dot {
    width: 8px;
    height: 8px;
    background: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
    opacity: 0.3;
  }

  .edit-dot:hover {
    background: var(--accent);
    opacity: 1;
    transform: scale(1.5);
  }

  .edit-dot.active {
    background: var(--accent);
    opacity: 1;
    box-shadow: 0 0 0 2px var(--accent-subtle);
  }

  .editable {
    outline: none;
    border-bottom: 1px solid transparent;
    transition: border-bottom 0.2s ease;
  }

  .editable:hover {
    border-bottom-color: var(--border-hover);
  }

  .editable:focus {
    border-bottom-color: var(--accent);
  }

  .edit-mode .editable {
    cursor: text;
  }

  .edit-mode .editable::after {
    content: ' ✎';
    font-size: 10px;
    color: var(--accent);
    opacity: 0.6;
  }

  /* ═══ MINIMAL BACKGROUND ═══ */
  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, var(--bg-deep) 0%, var(--bg-mid) 100%);
    pointer-events: none;
    z-index: 0;
  }

  /* ═══ BASE ═══ */
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: var(--font-display);
    background: var(--bg-deep);
    color: var(--text-primary);
    line-height: 1.6;
    min-height: 100vh;
    position: relative;
    z-index: 1;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
  }

  /* ═══ HEADER ═══ */
  .header {
    text-align: center;
    padding: 60px 20px 40px;
    position: relative;
  }

  .header-badge {
    font-family: var(--font-mono);
    font-size: 11px;
    font-weight: 400;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 8px;
  }

  .header h1 {
    font-size: clamp(2rem, 5vw, 3rem);
    font-weight: 400;
    letter-spacing: -1px;
    color: var(--text-primary);
    line-height: 1.1;
    margin-bottom: 8px;
  }

  .header p {
    color: var(--text-secondary);
    font-size: 14px;
    font-weight: 400;
    letter-spacing: 0px;
  }

  /* ═══ NAVIGATION ═══ */
  .tool-nav {
    display: flex;
    justify-content: center;
    gap: 0;
    margin-bottom: 40px;
    border-bottom: 1px solid var(--border);
  }

  .tool-tab {
    font-family: var(--font-mono);
    font-size: 12px;
    font-weight: 400;
    letter-spacing: 0.5px;
    padding: 12px 0;
    border: none;
    background: transparent;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    margin: 0 24px;
  }

  .tool-tab::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 1px;
    background: var(--accent);
    transition: width 0.2s ease;
  }

  .tool-tab:hover {
    color: var(--text-primary);
  }

  .tool-tab:hover::after {
    width: 100%;
  }

  .tool-tab.active {
    color: var(--accent);
  }

  .tool-tab.active::after {
    width: 100%;
  }

  /* ═══ PANELS ═══ */
  .tool-panel {
    display: none;
  }

  .tool-panel.active {
    display: block;
  }

  .panel-title {
    font-size: 1.8rem;
    font-weight: 400;
    letter-spacing: -0.5px;
    margin-bottom: 8px;
    color: var(--text-primary);
  }

  .panel-subtitle {
    color: var(--text-secondary);
    font-size: 14px;
    margin-bottom: 32px;
    font-weight: 300;
  }

  /* ═══ MINIMAL SECTIONS ═══ */
  .section {
    border-top: 1px solid var(--border);
    padding: 32px 0;
    margin-bottom: 16px;
  }

  .section:hover {
    border-top-color: var(--border-hover);
  }

  .section-label {
    font-family: var(--font-mono);
    font-size: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 16px;
    display: block;
  }

  /* ═══ BUTTONS ═══ */
  .btn {
    font-family: var(--font-mono);
    font-size: 12px;
    font-weight: 400;
    letter-spacing: 1px;
    padding: 12px 24px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
    text-transform: uppercase;
  }

  .btn-primary {
    border-color: var(--accent);
    color: var(--accent);
  }

  .btn-primary:hover { 
    background: var(--accent);
    color: var(--bg-deep);
  }

  .btn-secondary:hover { 
    border-color: var(--accent); 
    color: var(--text-primary); 
  }

  .btn-danger {
    border-color: var(--danger);
    color: var(--danger);
  }

  .btn-danger:hover { 
    background: var(--danger);
    color: var(--bg-deep);
  }

  .btn:disabled { 
    opacity: 0.3; 
    cursor: not-allowed; 
  }

  /* ═══ TIMER STYLES ═══ */
  .timer-presets {
    display: grid;
    gap: 1px;
    margin-bottom: 24px;
  }

  .preset-btn {
    font-family: var(--font-mono);
    font-size: 12px;
    padding: 16px 0;
    border: none;
    border-bottom: 1px solid transparent;
    background: transparent;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: left;
  }

  .preset-btn:hover { 
    color: var(--text-primary);
    border-bottom-color: var(--border-hover);
  }
  
  .preset-btn.selected { 
    color: var(--accent);
    border-bottom-color: var(--accent);
  }

  .preset-name {
    display: block;
    font-weight: 600;
    margin-bottom: 4px;
  }

  .preset-detail {
    font-size: 10px;
    color: var(--text-muted);
    letter-spacing: 0.5px;
  }

  .settings-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 20px;
    margin-bottom: 32px;
  }

  .setting-item {
    text-align: center;
  }

  .setting-label {
    font-family: var(--font-mono);
    font-size: 10px;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 8px;
  }

  .setting-value {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
  }

  .setting-value button {
    width: 32px;
    height: 32px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text-secondary);
    font-family: var(--font-mono);
    font-size: 16px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .setting-value button:hover {
    border-color: var(--accent);
    color: var(--accent);
  }

  .setting-value span {
    font-family: var(--font-mono);
    font-size: 18px;
    font-weight: 600;
    color: var(--text-primary);
    min-width: 40px;
  }

  .timer-display {
    text-align: center;
    padding: 40px 0;
  }

  .timer-time {
    font-family: var(--font-mono);
    font-size: clamp(4rem, 15vw, 8rem);
    font-weight: 700;
    letter-spacing: -2px;
    color: var(--text-primary);
    line-height: 1;
    transition: color 0.3s ease;
  }

  .timer-time.rest { color: var(--success); }
  .timer-time.work { color: var(--accent); }
  .timer-time.warning { color: var(--warning); animation: pulse 0.5s infinite; }
  .timer-time.done { color: var(--success); }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.6; }
  }

  .timer-phase {
    font-family: var(--font-mono);
    font-size: 14px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-top: 16px;
  }

  .timer-round {
    font-family: var(--font-mono);
    font-size: 12px;
    color: var(--text-muted);
    margin-top: 8px;
  }

  .timer-progress-bar {
    width: 100%;
    height: 4px;
    background: var(--bg-hover);
    margin: 24px 0;
  }

  .timer-progress-fill {
    height: 100%;
    background: var(--accent);
    transition: width 0.3s linear;
    width: 0%;
  }

  .timer-controls {
    display: flex;
    justify-content: center;
    gap: 16px;
    margin-top: 24px;
  }

  /* ═══ SKILL TREE ═══ */
  .skill-tracks {
    display: flex;
    flex-direction: column;
    gap: 40px;
  }

  .skill-track {
    border-top: 1px solid var(--border);
    padding-top: 24px;
  }

  .track-header {
    margin-bottom: 16px;
  }

  .track-name {
    font-size: 16px;
    font-weight: 400;
    letter-spacing: -0.3px;
    color: var(--text-primary);
    margin-bottom: 4px;
  }

  .track-level-label {
    font-family: var(--font-mono);
    font-size: 10px;
    color: var(--text-muted);
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  .skill-nodes {
    display: flex;
    gap: 1px;
    overflow-x: auto;
    padding-bottom: 16px;
  }

  .skill-node {
    flex-shrink: 0;
    width: 140px;
    text-align: center;
    position: relative;
    cursor: pointer;
    padding: 12px 8px;
    transition: all 0.3s ease;
  }

  .skill-node:hover { 
    background: var(--bg-hover); 
  }

  .skill-node::after {
    content: '';
    position: absolute;
    top: 28px;
    right: -1px;
    width: calc(100% - 60px);
    height: 1px;
    background: var(--border);
  }

  .skill-node:last-child::after { display: none; }

  .skill-node.completed::after { background: var(--success); }

  .node-indicator {
    width: 24px;
    height: 24px;
    margin: 0 auto 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--font-mono);
    font-size: 10px;
    transition: all 0.3s ease;
    border-bottom: 1px solid var(--border);
  }

  .skill-node.completed .node-indicator {
    border-bottom-color: var(--success);
    color: var(--success);
  }

  .skill-node.current .node-indicator {
    border-bottom-color: var(--accent);
    color: var(--accent);
  }

  .skill-node.locked .node-indicator {
    opacity: 0.4;
  }

  .node-name {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 4px;
    line-height: 1.2;
  }

  .node-desc {
    font-size: 10px;
    color: var(--text-muted);
    line-height: 1.2;
  }

  /* ═══ ASSESSMENT ═══ */
  .progress-dots {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 32px;
  }

  .progress-dot {
    width: 8px;
    height: 8px;
    background: var(--border);
    transition: all 0.3s ease;
  }

  .progress-dot.active { background: var(--accent); }
  .progress-dot.done { background: var(--success); }

  .assessment-question {
    max-width: 600px;
    margin: 0 auto;
    text-align: center;
  }

  .question-number {
    font-family: var(--font-mono);
    font-size: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 16px;
  }

  .question-text {
    font-size: 1.4rem;
    font-weight: 400;
    line-height: 1.3;
    margin-bottom: 32px;
    color: var(--text-primary);
  }

  .answer-options {
    display: grid;
    gap: 12px;
    max-width: 400px;
    margin: 0 auto;
  }

  .answer-btn {
    padding: 16px 20px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 14px;
    text-align: left;
  }

  .answer-btn:hover {
    border-color: var(--accent);
    color: var(--text-primary);
  }

  .result-card {
    text-align: center;
    max-width: 600px;
    margin: 0 auto;
    padding: 40px 0;
  }

  .result-title {
    font-size: 1.8rem;
    font-weight: 400;
    margin-bottom: 16px;
    color: var(--text-primary);
  }

  .result-desc {
    color: var(--text-secondary);
    margin-bottom: 32px;
    line-height: 1.6;
  }

  .rec-grid {
    display: grid;
    gap: 20px;
    margin-top: 32px;
    text-align: left;
  }

  .rec-item {
    border-top: 1px solid var(--border);
    padding-top: 16px;
  }

  .rec-item h4 {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 8px;
  }

  .rec-item p {
    font-size: 12px;
    color: var(--text-secondary);
    line-height: 1.5;
  }

  /* ═══ TRAINING LOG ═══ */
  .log-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
  }

  .log-date {
    font-family: var(--font-mono);
    font-size: 14px;
    color: var(--text-primary);
  }

  .exercise-selector {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 12px;
    margin-bottom: 20px;
  }

  .exercise-select {
    padding: 12px;
    border: 1px solid var(--border);
    background: var(--bg-deep);
    color: var(--text-primary);
    font-family: var(--font-mono);
    font-size: 12px;
  }

  .add-exercise-btn {
    padding: 12px 20px;
    border: 1px solid var(--accent);
    background: transparent;
    color: var(--accent);
    cursor: pointer;
    font-family: var(--font-mono);
    font-size: 12px;
    text-transform: uppercase;
    transition: all 0.2s ease;
  }

  .add-exercise-btn:hover {
    background: var(--accent);
    color: var(--bg-deep);
  }

  .workout-entry {
    border-top: 1px solid var(--border);
    padding: 16px 0;
    display: grid;
    grid-template-columns: 1fr auto auto;
    align-items: center;
    gap: 16px;
  }

  .exercise-name {
    font-weight: 600;
    color: var(--text-primary);
  }

  .sets-info {
    font-family: var(--font-mono);
    font-size: 12px;
    color: var(--text-muted);
  }

  .entry-actions {
    display: flex;
    gap: 8px;
  }

  .entry-actions button {
    padding: 6px 12px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text-muted);
    cursor: pointer;
    font-family: var(--font-mono);
    font-size: 10px;
    transition: all 0.2s ease;
  }

  .entry-actions button:hover {
    border-color: var(--accent);
    color: var(--text-primary);
  }

  .set-inputs {
    display: grid;
    grid-template-columns: 1fr 1fr auto;
    gap: 8px;
    margin-top: 12px;
  }

  .set-inputs input {
    padding: 8px;
    border: 1px solid var(--border);
    background: var(--bg-deep);
    color: var(--text-primary);
    font-family: var(--font-mono);
    font-size: 12px;
  }

  .set-inputs button {
    padding: 8px 12px;
    border: 1px solid var(--success);
    background: transparent;
    color: var(--success);
    cursor: pointer;
    font-family: var(--font-mono);
    font-size: 12px;
  }

  .set-inputs button:hover {
    background: var(--success);
    color: var(--bg-deep);
  }

  .daily-stats {
    background: var(--bg-hover);
    padding: 20px;
    margin-bottom: 24px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 16px;
    text-align: center;
  }

  .stat-item h4 {
    font-family: var(--font-mono);
    font-size: 10px;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 4px;
  }

  .stat-item span {
    font-size: 1.4rem;
    font-weight: 600;
    color: var(--accent);
  }

  .export-controls {
    text-align: center;
    margin-top: 32px;
  }

  /* ═══ SCREEN FLASH ═══ */
  .screen-flash {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.1);
    opacity: 0;
    pointer-events: none;
    z-index: 9999;
    transition: opacity 0.1s ease;
  }

  .screen-flash.active { opacity: 1; }

  /* ═══ FOOTER ═══ */
  .footer {
    text-align: center;
    padding: 60px 20px 40px;
    border-top: 1px solid var(--border);
    margin-top: 60px;
  }

  .footer-logo {
    font-family: var(--font-mono);
    font-size: 14px;
    font-weight: 400;
    color: var(--text-primary);
  }

  .footer p {
    color: var(--text-muted);
    font-size: 11px;
    margin-top: 8px;
    font-family: var(--font-mono);
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  /* ═══ RESPONSIVE ═══ */
  @media (max-width: 768px) {
    .container { padding: 16px; }
    .skill-nodes { gap: 8px; }
    .skill-node { width: 120px; }
    .settings-grid { grid-template-columns: 1fr; }
    .tool-nav { flex-wrap: wrap; gap: 8px; }
    .tool-tab { margin: 0 12px; }
  }
</style>
</head>
<body>
<div class="container">

<!-- Screen Flash -->
<div class="screen-flash" id="screenFlash"></div>

<!-- ═══ HEADER ═══ -->
<header class="header">
  <div style="position: absolute; top: 16px; right: 16px;">
    <div class="edit-dot" onclick="toggleEditMode()" title="Edit Mode"></div>
  </div>
  <div class="header-badge">SATURNO BONUS VAULT</div>
  <h1>Interactive Tools</h1>
  <p>Training • Progress • Evolution</p>
</header>

<!-- ═══ NAVIGATION ═══ -->
<nav class="tool-nav">
  <button class="tool-tab active" onclick="switchTool('timer')">Timer</button>
  <button class="tool-tab" onclick="switchTool('skills')">Skills</button>
  <button class="tool-tab" onclick="switchTool('assess')">Assessment</button>
  <button class="tool-tab" onclick="switchTool('log')">Log</button>
</nav>

<!-- ═══ TOOL PANELS ═══ -->
<main class="tool-content">

<!-- TOOL 1: WORKOUT TIMER -->
<section class="tool-panel active" id="panel-timer">
  <h2 class="panel-title">Workout Timer</h2>
  <p class="panel-subtitle">EMOM, Tabata, intervals, or custom</p>

  <div class="section">
    <span class="section-label">Presets</span>
    <div class="timer-presets">
      <button class="preset-btn selected" onclick="selectPreset('tabata')">
        <span class="preset-name">Tabata</span>
        <span class="preset-detail">20s work / 10s rest × 8</span>
      </button>
      <button class="preset-btn" onclick="selectPreset('emom')">
        <span class="preset-name">EMOM</span>
        <span class="preset-detail">60s intervals × 10</span>
      </button>
      <button class="preset-btn" onclick="selectPreset('skill')">
        <span class="preset-name">Skill Work</span>
        <span class="preset-detail">45s work / 90s rest × 5</span>
      </button>
      <button class="preset-btn" onclick="selectPreset('endurance')">
        <span class="preset-name">Endurance</span>
        <span class="preset-detail">60s work / 30s rest × 12</span>
      </button>
      <button class="preset-btn" onclick="selectPreset('custom')">
        <span class="preset-name">Custom</span>
        <span class="preset-detail">Set your own</span>
      </button>
    </div>
  </div>

  <div class="section">
    <span class="section-label">Settings</span>
    <div class="settings-grid">
      <div class="setting-item">
        <div class="setting-label">Work (s)</div>
        <div class="setting-value">
          <button onclick="adjustSetting('work', -5)">−</button>
          <span id="setting-work">20</span>
          <button onclick="adjustSetting('work', 5)">+</button>
        </div>
      </div>
      <div class="setting-item">
        <div class="setting-label">Rest (s)</div>
        <div class="setting-value">
          <button onclick="adjustSetting('rest', -5)">−</button>
          <span id="setting-rest">10</span>
          <button onclick="adjustSetting('rest', 5)">+</button>
        </div>
      </div>
      <div class="setting-item">
        <div class="setting-label">Rounds</div>
        <div class="setting-value">
          <button onclick="adjustSetting('rounds', -1)">−</button>
          <span id="setting-rounds">8</span>
          <button onclick="adjustSetting('rounds', 1)">+</button>
        </div>
      </div>
    </div>
  </div>

  <div class="section">
    <span class="section-label">Custom Audio</span>
    <div style="margin-bottom: 12px;">
      <input type="file" id="audioUpload" accept="audio/*" style="display: none;" onchange="handleAudioUpload(event)">
      <button class="btn btn-secondary" onclick="document.getElementById('audioUpload').click()">Upload Completion Sound</button>
      <button class="btn btn-secondary" onclick="testCustomAudio()" id="testAudioBtn" disabled>Test Audio</button>
    </div>
    <div id="audioStatus" style="font-family: var(--font-mono); font-size: 10px; color: var(--text-muted);"></div>
  </div>

  <div class="section">
    <div class="timer-display">
      <div class="timer-time" id="timerDisplay">00:20</div>
      <div class="timer-phase" id="timerPhase">READY</div>
      <div class="timer-round" id="timerRound"></div>
      <div class="timer-progress-bar">
        <div class="timer-progress-fill" id="timerProgress"></div>
      </div>
    </div>
    <div class="timer-controls">
      <button class="btn btn-primary" id="btnStart" onclick="startTimer()">Start</button>
      <button class="btn btn-secondary" id="btnPause" onclick="pauseTimer()" disabled>Pause</button>
      <button class="btn btn-danger" id="btnReset" onclick="resetTimer()">Reset</button>
    </div>
  </div>
</section>

<!-- TOOL 2: SKILL PROGRESSION TREE -->
<section class="tool-panel" id="panel-skills">
  <h2 class="panel-title">Skill Progression Tree</h2>
  <p class="panel-subtitle">Track mastery across movement patterns</p>
  
  <div class="skill-tracks" id="skillContainer"></div>
</section>

<!-- TOOL 3: MOVEMENT ASSESSMENT -->
<section class="tool-panel" id="panel-assess">
  <h2 class="panel-title">Movement Assessment</h2>
  <p class="panel-subtitle">Discover your current level</p>
  
  <div id="assessmentContainer"></div>
</section>

<!-- TOOL 4: TRAINING LOG -->
<section class="tool-panel" id="panel-log">
  <h2 class="panel-title">Training Log</h2>
  <p class="panel-subtitle">Track workouts and progression</p>

  <div class="log-header">
    <div class="log-date" id="currentDate"></div>
    <button class="btn btn-secondary" onclick="exportLog()">Export</button>
  </div>

  <div class="daily-stats" id="dailyStats">
    <div class="stat-item">
      <h4>Total Sets</h4>
      <span id="totalSets">0</span>
    </div>
    <div class="stat-item">
      <h4>Total Reps</h4>
      <span id="totalReps">0</span>
    </div>
    <div class="stat-item">
      <h4>Exercises</h4>
      <span id="totalExercises">0</span>
    </div>
  </div>

  <div class="exercise-selector">
    <select id="exerciseSelect" class="exercise-select">
      <option>Push-Up</option>
      <option>Pull-Up</option>
      <option>Squat</option>
      <option>Plank</option>
      <option>Handstand Hold</option>
      <option>L-Sit</option>
      <option>Dips</option>
      <option>Pike Push-Up</option>
      <option>Archer Push-Up</option>
      <option>Pistol Squat</option>
      <option>Muscle-Up</option>
      <option>Front Lever</option>
      <option>Planche</option>
      <option>Human Flag</option>
      <option>One-Arm Push-Up</option>
      <option>One-Arm Pull-Up</option>
      <option>Hollow Body Hold</option>
      <option>Dead Hang</option>
    </select>
    <button class="add-exercise-btn" onclick="addExercise()">Add Exercise</button>
  </div>

  <div id="workoutEntries"></div>
</section>

</main>

<!-- ═══ FOOTER ═══ -->
<footer class="footer">
  <div class="footer-logo">SATURNO MOVEMENT</div>
  <p>Bonus Vault Tools</p>
</footer>

</div>

<script>
// ═══════════════════════════════════════════
// EDIT MODE
// ═══════════════════════════════════════════
let editMode = false;
let editData = JSON.parse(localStorage.getItem('saturno_edit_data') || '{}');

function toggleEditMode() {
  if (!editMode) {
    // Only ask password when entering edit mode
    const password = prompt('Enter password to enable edit mode:');
    if (password !== 'saturno2026') {
      if (password) alert('Incorrect password');
      return;
    }
  }
  
  editMode = !editMode;
  const dot = document.querySelector('.edit-dot');
  const body = document.body;
  
  if (editMode) {
    dot.classList.add('active');
    body.classList.add('edit-mode');
    makeElementsEditable();
    beep(800, 0.1, 0.2); // Enter edit mode sound
  } else {
    dot.classList.remove('active');
    body.classList.remove('edit-mode');
    removeEditability();
    saveEditData();
    beep(600, 0.1, 0.2); // Exit edit mode sound
  }
}

function makeElementsEditable() {
  // Re-enable editing when switching tools or refreshing panels
  requestAnimationFrame(() => {
    // Skill names in skill tree
    document.querySelectorAll('.node-name, .track-name').forEach(el => {
      if (!el.contentEditable || el.contentEditable === 'false') {
        el.contentEditable = true;
        el.classList.add('editable');
        el.addEventListener('blur', saveEditData);
      }
    });
    
    // Exercise names in log
    document.querySelectorAll('.exercise-name').forEach(el => {
      if (!el.contentEditable || el.contentEditable === 'false') {
        el.contentEditable = true;
        el.classList.add('editable');
        el.addEventListener('blur', saveEditData);
      }
    });
    
    // Panel titles and descriptions
    document.querySelectorAll('.panel-title, .panel-subtitle').forEach(el => {
      if (!el.contentEditable || el.contentEditable === 'false') {
        el.contentEditable = true;
        el.classList.add('editable');
        el.addEventListener('blur', saveEditData);
      }
    });
    
    // Assessment questions and answers (when rendered)
    document.querySelectorAll('.question-text, .answer-btn span').forEach(el => {
      if (!el.contentEditable || el.contentEditable === 'false') {
        el.contentEditable = true;
        el.classList.add('editable');
        el.addEventListener('blur', saveEditData);
      }
    });
    
    // Preset names and details
    document.querySelectorAll('.preset-name, .preset-detail').forEach(el => {
      if (!el.contentEditable || el.contentEditable === 'false') {
        el.contentEditable = true;
        el.classList.add('editable');
        el.addEventListener('blur', saveEditData);
      }
    });
  });
}

function removeEditability() {
  document.querySelectorAll('.editable').forEach(el => {
    el.contentEditable = false;
    el.classList.remove('editable');
    el.removeEventListener('blur', saveEditData);
  });
}

function saveEditData() {
  if (!editMode) return;
  
  // Save all editable content
  const data = {};
  document.querySelectorAll('[contenteditable="true"]').forEach((el, i) => {
    data['element_' + i] = {
      content: el.textContent,
      class: el.className,
      tag: el.tagName
    };
  });
  
  editData = data;
  localStorage.setItem('saturno_edit_data', JSON.stringify(editData));
  beep(900, 0.05, 0.1); // Quick save beep
}

function loadEditData() {
  // This would restore previous edits - implement if needed
}

// ═══════════════════════════════════════════
// NAVIGATION
// ═══════════════════════════════════════════
function switchTool(tool) {
  document.querySelectorAll('.tool-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tool-tab').forEach(t => t.classList.remove('active'));
  document.getElementById('panel-' + tool).classList.add('active');
  event.target.classList.add('active');
  
  // Re-apply edit mode if active (after DOM updates)
  if (editMode) {
    setTimeout(makeElementsEditable, 100);
  }
}

// ═══════════════════════════════════════════
// AUDIO ENGINE (Web Audio API + Custom Sounds)
// ═══════════════════════════════════════════
let audioCtx;
let customAudio = {};

// Initialize custom audio files
function initCustomAudio() {
  // Load your Early_rise.wav file
  customAudio.earlyRise = new Audio('./Early_rise.wav');
  customAudio.earlyRise.preload = 'auto';
  customAudio.earlyRise.volume = 0.7;
  
  // Set audio status when loaded
  customAudio.earlyRise.addEventListener('loadeddata', () => {
    const status = document.getElementById('audioStatus');
    if (status) {
      status.textContent = 'Loaded: Early_rise.wav (custom completion sound)';
      document.getElementById('testAudioBtn').disabled = false;
    }
  });
  
  // You can add more custom audio files here
  // customAudio.success = new Audio('./success.wav');
  // customAudio.warning = new Audio('./warning.wav');
}

function initAudio() {
  if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  initCustomAudio();
}

function beep(freq = 800, duration = 0.15, volume = 0.3) {
  initAudio();
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  osc.frequency.value = freq;
  osc.type = 'sine';
  gain.gain.setValueAtTime(volume, audioCtx.currentTime);
  gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
  osc.start();
  osc.stop(audioCtx.currentTime + duration);
}

function playCustomSound(soundName) {
  if (customAudio[soundName]) {
    customAudio[soundName].currentTime = 0;
    customAudio[soundName].volume = 0.5;
    customAudio[soundName].play().catch(e => console.log('Audio play failed:', e));
  }
}

function flash() {
  const el = document.getElementById('screenFlash');
  el.classList.add('active');
  setTimeout(() => el.classList.remove('active'), 150);
}

function handleAudioUpload(event) {
  const file = event.target.files[0];
  if (!file) return;
  
  const url = URL.createObjectURL(file);
  customAudio.earlyRise.src = url;
  customAudio.earlyRise.load();
  
  document.getElementById('testAudioBtn').disabled = false;
  document.getElementById('audioStatus').textContent = `Loaded: ${file.name} (${(file.size / 1024).toFixed(1)}kb)`;
  
  beep(700, 0.1, 0.2);
}

function testCustomAudio() {
  playCustomSound('earlyRise');
}

// ═══════════════════════════════════════════
// TOOL 1: WORKOUT TIMER
// ═══════════════════════════════════════════
let timerState = {
  workTime: 20,
  restTime: 10,
  rounds: 8,
  currentRound: 1,
  currentTime: 20,
  phase: 'ready', // ready, work, rest, done
  running: false,
  interval: null
};

const presets = {
  tabata: { work: 20, rest: 10, rounds: 8 },
  emom: { work: 60, rest: 0, rounds: 10 },
  skill: { work: 45, rest: 90, rounds: 5 },
  endurance: { work: 60, rest: 30, rounds: 12 },
  custom: { work: 30, rest: 15, rounds: 6 }
};

function selectPreset(preset) {
  document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('selected'));
  event.target.classList.add('selected');
  
  const config = presets[preset];
  timerState.workTime = config.work;
  timerState.restTime = config.rest;
  timerState.rounds = config.rounds;
  timerState.currentTime = config.work;
  timerState.phase = 'ready';
  
  document.getElementById('setting-work').textContent = config.work;
  document.getElementById('setting-rest').textContent = config.rest;
  document.getElementById('setting-rounds').textContent = config.rounds;
  
  updateTimerDisplay();
}

function adjustSetting(setting, delta) {
  if (setting === 'work') {
    timerState.workTime = Math.max(5, timerState.workTime + delta);
    timerState.currentTime = timerState.workTime;
    document.getElementById('setting-work').textContent = timerState.workTime;
  } else if (setting === 'rest') {
    timerState.restTime = Math.max(0, timerState.restTime + delta);
    document.getElementById('setting-rest').textContent = timerState.restTime;
  } else if (setting === 'rounds') {
    timerState.rounds = Math.max(1, timerState.rounds + delta);
    document.getElementById('setting-rounds').textContent = timerState.rounds;
  }
  updateTimerDisplay();
}

function formatTime(seconds) {
  const mins = Math.floor(seconds / 60);
  const secs = seconds % 60;
  return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
}

function updateTimerDisplay() {
  const display = document.getElementById('timerDisplay');
  const phase = document.getElementById('timerPhase');
  const round = document.getElementById('timerRound');
  const progress = document.getElementById('timerProgress');
  
  display.textContent = formatTime(timerState.currentTime);
  phase.textContent = timerState.phase.toUpperCase();
  
  if (timerState.phase === 'ready') {
    round.textContent = '';
    progress.style.width = '0%';
  } else if (timerState.phase === 'done') {
    round.textContent = 'COMPLETE';
    progress.style.width = '100%';
  } else {
    round.textContent = `ROUND ${timerState.currentRound} / ${timerState.rounds}`;
    const totalTime = timerState.phase === 'work' ? timerState.workTime : timerState.restTime;
    const elapsed = totalTime - timerState.currentTime;
    progress.style.width = `${(elapsed / totalTime) * 100}%`;
  }
  
  // Color coding
  display.className = 'timer-time';
  if (timerState.phase === 'work') display.classList.add('work');
  if (timerState.phase === 'rest') display.classList.add('rest');
  if (timerState.phase === 'done') display.classList.add('done');
  if (timerState.currentTime <= 3 && timerState.currentTime > 0) display.classList.add('warning');
}

function startTimer() {
  timerState.running = true;
  timerState.phase = 'work';
  timerState.currentRound = 1;
  timerState.currentTime = timerState.workTime;
  
  document.getElementById('btnStart').disabled = true;
  document.getElementById('btnPause').disabled = false;
  
  timerState.interval = setInterval(runTimer, 1000);
  updateTimerDisplay();
}

function pauseTimer() {
  timerState.running = !timerState.running;
  const btn = document.getElementById('btnPause');
  
  if (timerState.running) {
    timerState.interval = setInterval(runTimer, 1000);
    btn.textContent = 'PAUSE';
  } else {
    clearInterval(timerState.interval);
    btn.textContent = 'RESUME';
  }
}

function resetTimer() {
  clearInterval(timerState.interval);
  timerState.running = false;
  timerState.phase = 'ready';
  timerState.currentRound = 1;
  timerState.currentTime = timerState.workTime;
  
  document.getElementById('btnStart').disabled = false;
  document.getElementById('btnPause').disabled = true;
  document.getElementById('btnPause').textContent = 'PAUSE';
  
  updateTimerDisplay();
}

function runTimer() {
  timerState.currentTime--;
  
  if (timerState.currentTime <= 0) {
    if (timerState.phase === 'work') {
      // Work phase ended, start rest
      if (timerState.restTime > 0) {
        timerState.phase = 'rest';
        timerState.currentTime = timerState.restTime;
        beep(600, 0.2, 0.4);
      } else {
        // No rest, go to next round
        timerState.currentRound++;
        if (timerState.currentRound > timerState.rounds) {
          finishTimer();
          return;
        } else {
          timerState.currentTime = timerState.workTime;
          beep(800, 0.2, 0.4);
        }
      }
    } else if (timerState.phase === 'rest') {
      // Rest phase ended, start next work round
      timerState.phase = 'work';
      timerState.currentRound++;
      
      if (timerState.currentRound > timerState.rounds) {
        finishTimer();
        return;
      } else {
        timerState.currentTime = timerState.workTime;
        beep(800, 0.2, 0.4);
      }
    }
  }
  
  // Warning beeps
  if (timerState.currentTime <= 3 && timerState.currentTime > 0) {
    beep(1000, 0.1, 0.2);
    flash();
  }
  
  updateTimerDisplay();
}

function finishTimer() {
  clearInterval(timerState.interval);
  timerState.running = false;
  timerState.phase = 'done';
  timerState.currentTime = 0;
  
  // Play custom completion sound or fallback to beeps
  if (customAudio.earlyRise && customAudio.earlyRise.src) {
    playCustomSound('earlyRise');
  } else {
    beep(1000, 0.5, 0.5);
    setTimeout(() => beep(1200, 0.5, 0.5), 200);
    setTimeout(() => beep(1500, 0.8, 0.5), 400);
  }
  
  document.getElementById('btnStart').disabled = false;
  document.getElementById('btnPause').disabled = true;
  updateTimerDisplay();
}

// ═══════════════════════════════════════════
// TOOL 2: SKILL PROGRESSION TREE
// ═══════════════════════════════════════════
const skillTracks = [
  {
    name: 'Push', color: '#ef4444',
    skills: [
      { name: 'Wall Push-Up', desc: 'Foundation' },
      { name: 'Knee Push-Up', desc: 'Build strength' },
      { name: 'Push-Up', desc: 'Standard form' },
      { name: 'Diamond Push-Up', desc: 'Tricep focus' },
      { name: 'Archer Push-Up', desc: 'Unilateral' },
      { name: 'One-Arm Push-Up', desc: 'Elite level' }
    ]
  },
  {
    name: 'Pull', color: '#06b6d4',
    skills: [
      { name: 'Dead Hang', desc: 'Grip foundation' },
      { name: 'Scap Pulls', desc: 'Activation' },
      { name: 'Negative Pull-Up', desc: 'Eccentric' },
      { name: 'Pull-Up', desc: 'Standard' },
      { name: 'L-Sit Pull-Up', desc: 'Core integration' },
      { name: 'Muscle-Up', desc: 'Elite transition' }
    ]
  },
  {
    name: 'Legs', color: '#10b981',
    skills: [
      { name: 'Bodyweight Squat', desc: 'Base pattern' },
      { name: 'Split Squat', desc: 'Balance' },
      { name: 'Bulgarian Split', desc: 'Deep unilateral' },
      { name: 'Pistol Negative', desc: 'Eccentric single' },
      { name: 'Pistol Squat', desc: 'Full ROM' },
      { name: 'Shrimp Squat', desc: 'Elite balance' }
    ]
  },
  {
    name: 'Handstand', color: '#8b5cf6',
    skills: [
      { name: 'Wrist Prep', desc: 'Mobility first' },
      { name: 'Wall Hold', desc: 'Build time' },
      { name: 'Chest-to-Wall', desc: 'Alignment' },
      { name: 'Kick-Up', desc: 'Entry skill' },
      { name: 'Freestanding', desc: '30s holds' },
      { name: 'Handstand Walk', desc: 'Dynamic balance' }
    ]
  },
  {
    name: 'Core', color: '#f59e0b',
    skills: [
      { name: 'Hollow Hold', desc: 'Foundation' },
      { name: 'Hanging Knee Raise', desc: 'Compression' },
      { name: 'Hanging Leg Raise', desc: 'Full range' },
      { name: 'Toes to Bar', desc: 'Power and flex' },
      { name: 'L-Sit', desc: 'Isometric' },
      { name: 'V-Sit', desc: 'Elite hold' }
    ]
  }
];

let skillProgress = JSON.parse(localStorage.getItem('skill_progress') || '{}');

function renderSkillTree() {
  const container = document.getElementById('skillContainer');
  
  container.innerHTML = skillTracks.map((track, ti) => {
    let html = `
      <div class="skill-track" style="border-top-color: ${track.color}40;">
        <div class="track-header">
          <div class="track-name">${track.name}</div>
          <div class="track-level-label">${getTrackProgress(ti)} / ${track.skills.length} skills</div>
        </div>
        <div class="skill-nodes">
    `;

    track.skills.forEach((skill, si) => {
      const key = ti + '-' + si;
      const status = skillProgress[key] || 'locked';
      const prevKey = ti + '-' + (si - 1);
      const prevStatus = si === 0 ? 'completed' : (skillProgress[prevKey] || 'locked');
      
      // Auto-unlock first skill and skills after completed ones
      let effectiveStatus = status;
      if (si === 0 && status === 'locked') effectiveStatus = 'current';
      if (prevStatus === 'completed' && status === 'locked') effectiveStatus = 'current';

      html += `
        <div class="skill-node ${effectiveStatus}" onclick="toggleSkill(${ti}, ${si})" title="${skill.name}: ${skill.desc}">
          <div class="node-indicator">${si + 1}</div>
          <div class="node-name">${skill.name}</div>
          <div class="node-desc">${skill.desc}</div>
        </div>
      `;
    });

    html += `
        </div>
      </div>
    `;

    return html;
  }).join('');
}

function getTrackProgress(trackIndex) {
  let completed = 0;
  skillTracks[trackIndex].skills.forEach((_, si) => {
    const key = trackIndex + '-' + si;
    if (skillProgress[key] === 'completed') completed++;
  });
  return completed;
}

function toggleSkill(trackIndex, skillIndex) {
  const key = trackIndex + '-' + skillIndex;
  const current = skillProgress[key] || 'locked';
  
  // Check if skill can be toggled (not locked)
  const prevKey = trackIndex + '-' + (skillIndex - 1);
  const prevStatus = skillIndex === 0 ? 'completed' : (skillProgress[prevKey] || 'locked');
  
  if (skillIndex > 0 && prevStatus !== 'completed') return; // Can't access locked skills
  
  // Toggle between current and completed
  if (current === 'current' || current === 'locked') {
    skillProgress[key] = 'completed';
    beep(800, 0.2, 0.3);
  } else {
    skillProgress[key] = 'current';
    beep(600, 0.2, 0.3);
  }
  
  localStorage.setItem('skill_progress', JSON.stringify(skillProgress));
  renderSkillTree();
}

// ═══════════════════════════════════════════
// TOOL 3: MOVEMENT ASSESSMENT
// ═══════════════════════════════════════════
const assessQuestions = [
  {
    q: "How long can you hold a dead hang?",
    answers: [
      { text: "Less than 15 seconds", score: 1 },
      { text: "15–30 seconds", score: 2 },
      { text: "30–60 seconds", score: 3 },
      { text: "60+ seconds", score: 4 }
    ]
  },
  {
    q: "What's your max push-up set?",
    answers: [
      { text: "0–5 push-ups", score: 1 },
      { text: "5–15 push-ups", score: 2 },
      { text: "15–30 push-ups", score: 3 },
      { text: "30+ push-ups", score: 4 }
    ]
  },
  {
    q: "Can you do a pull-up?",
    answers: [
      { text: "Not yet", score: 1 },
      { text: "1–3 pull-ups", score: 2 },
      { text: "4–10 pull-ups", score: 3 },
      { text: "10+ or weighted", score: 4 }
    ]
  },
  {
    q: "How's your handstand?",
    answers: [
      { text: "Never tried or scared of it", score: 1 },
      { text: "Can do wall-assisted holds", score: 2 },
      { text: "Working on freestanding (5-15s)", score: 3 },
      { text: "Solid 30s+ freestanding", score: 4 }
    ]
  },
  {
    q: "How consistent is your training?",
    answers: [
      { text: "Just starting out", score: 1 },
      { text: "1–2 times per week", score: 2 },
      { text: "3–4 times per week", score: 3 },
      { text: "5+ times, structured program", score: 4 }
    ]
  },
  {
    q: "What's your L-sit like?",
    answers: [
      { text: "Can't lift off yet", score: 1 },
      { text: "Tuck L-sit (knees bent)", score: 2 },
      { text: "One leg extended", score: 3 },
      { text: "Full L-sit 10s+", score: 4 }
    ]
  }
];

const assessLevels = [
  {
    min: 6, max: 10, title: "Foundation Builder",
    desc: "You're at the beginning of an incredible journey. Focus on building base strength, joint preparation, and movement quality. The fundamentals are everything.",
    recs: [
      { title: "Start Here", desc: "Wall push-ups, dead hangs, bodyweight squats. Master form before adding reps." },
      { title: "Mobility", desc: "Daily wrist prep, shoulder circles, hip openers. 10 min every morning." },
      { title: "Consistency", desc: "3x per week minimum. Short sessions (20-30 min) are better than skipping." }
    ]
  },
  {
    min: 11, max: 16, title: "Rising Athlete",
    desc: "You've got the basics down. Now it's time to push into progressions, build skill work habits, and start targeting specific goals.",
    recs: [
      { title: "Progressions", desc: "Move from standard to archer push-ups. Work negative pull-ups for 5×5." },
      { title: "Skill Blocks", desc: "Add 15 min handstand practice. Wall holds → chest-to-wall → kick-ups." },
      { title: "Structure", desc: "Push/Pull/Legs split or Upper/Lower. Track your sets and reps." }
    ]
  },
  {
    min: 17, max: 20, title: "Advanced Practitioner",
    desc: "You're strong, consistent, and skilled. Time for high-level progressions, skill combinations, and periodized training.",
    recs: [
      { title: "Elite Skills", desc: "Muscle-up training, freestanding handstand, pistol squats, front lever progressions." },
      { title: "Periodization", desc: "Alternate strength and skill blocks. Deload every 4th week." },
      { title: "Create", desc: "Design your own flows. Combine skills. Express yourself through movement." }
    ]
  },
  {
    min: 21, max: 24, title: "Movement Master",
    desc: "You're operating at an elite level. Focus on mastery, creativity, and sharing your knowledge with others.",
    recs: [
      { title: "Mastery", desc: "One-arm skills, planche, front/back lever, handstand press. Refine endlessly." },
      { title: "Flow State", desc: "Create seamless transitions. Movement is art now." },
      { title: "Teach", desc: "Your experience is valuable. Consider coaching, content, or community building." }
    ]
  }
];

let assessState = { current: 0, answers: [], total: 0 };

function renderAssessment() {
  const container = document.getElementById('assessmentContainer');
  
  if (assessState.current >= assessQuestions.length) {
    // Show results
    showResults(container);
    return;
  }

  if (assessState.current === 0 && assessState.answers.length === 0) {
    // Initial state
    container.innerHTML = `
      <div class="section" style="text-align: center; padding: 48px 0;">
        <h3 style="font-size: 1.4rem; margin-bottom: 12px;">Discover Your Movement Level</h3>
        <p style="color: var(--text-secondary); margin-bottom: 32px; max-width: 400px; margin-left: auto; margin-right: auto;">
          Answer 6 quick questions and get a personalized assessment of your calisthenics level with tailored recommendations.
        </p>
        <button class="btn btn-primary" onclick="startAssessment()">Begin Assessment</button>
      </div>
    `;
    return;
  }

  // Show current question
  const q = assessQuestions[assessState.current];
  container.innerHTML = `
    <div class="progress-dots">
      ${assessQuestions.map((_, i) => `
        <div class="progress-dot ${i < assessState.current ? 'done' : ''} ${i === assessState.current ? 'active' : ''}"></div>
      `).join('')}
    </div>
    <div class="section assessment-question">
      <div class="question-number">QUESTION ${assessState.current + 1} OF ${assessQuestions.length}</div>
      <div class="question-text">${q.q}</div>
      <div class="answer-options">
        ${q.answers.map((a, i) => `
          <button class="answer-btn" onclick="selectAnswer(${i}, ${a.score})">
            <span>${a.text}</span>
          </button>
        `).join('')}
      </div>
    </div>
  `;
}

function startAssessment() {
  assessState = { current: 0, answers: [], total: 0 };
  renderAssessment();
}

function selectAnswer(answerIndex, score) {
  assessState.answers.push({ index: answerIndex, score: score });
  assessState.total += score;
  assessState.current++;
  
  beep(700, 0.1, 0.2);
  
  setTimeout(() => {
    renderAssessment();
  }, 150);
}

function showResults(container) {
  const total = assessState.total;
  const level = assessLevels.find(l => total >= l.min && total <= l.max);
  
  container.innerHTML = `
    <div class="result-card">
      <div class="result-title">${level.title}</div>
      <div style="font-family: var(--font-mono); font-size: 13px; color: var(--accent); margin-bottom: 16px;">
        Score: ${total} / ${assessQuestions.length * 4}
      </div>
      <div class="result-desc">${level.desc}</div>
      <div class="rec-grid">
        ${level.recs.map(r => `
          <div class="rec-item">
            <h4>${r.title}</h4>
            <p>${r.desc}</p>
          </div>
        `).join('')}
      </div>
      <div style="margin-top: 28px;">
        <button class="btn btn-primary" onclick="startAssessment()">Retake</button>
      </div>
    </div>
  `;
}

// ═══════════════════════════════════════════
// TOOL 4: TRAINING LOG
// ═══════════════════════════════════════════
let workoutLog = JSON.parse(localStorage.getItem('workout_log') || '{}');
let currentDate = new Date().toISOString().split('T')[0];

const exerciseLibrary = [
  { name: 'Push-Up', category: 'push' },
  { name: 'Pull-Up', category: 'pull' },
  { name: 'Squat', category: 'legs' },
  { name: 'Plank', category: 'core' },
  { name: 'Handstand Hold', category: 'skill' },
  { name: 'L-Sit', category: 'core' },
  { name: 'Dips', category: 'push' },
  { name: 'Pike Push-Up', category: 'push' },
  { name: 'Archer Push-Up', category: 'push' },
  { name: 'Pistol Squat', category: 'legs' },
  { name: 'Muscle-Up', category: 'pull' },
  { name: 'Front Lever', category: 'skill' },
  { name: 'Planche', category: 'skill' },
  { name: 'Human Flag', category: 'skill' },
  { name: 'One-Arm Push-Up', category: 'push' },
  { name: 'One-Arm Pull-Up', category: 'pull' },
  { name: 'Hollow Body Hold', category: 'core' },
  { name: 'Dead Hang', category: 'pull' }
];

function renderLog() {
  document.getElementById('currentDate').textContent = new Date().toLocaleDateString();
  updateDailyStats();
  renderWorkoutEntries();
}

function addExercise() {
  const select = document.getElementById('exerciseSelect');
  const exerciseName = select.value;
  
  if (!workoutLog[currentDate]) workoutLog[currentDate] = [];
  
  const entry = {
    id: Date.now(),
    name: exerciseName,
    sets: [],
    category: exerciseLibrary.find(e => e.name === exerciseName)?.category || 'other'
  };
  
  workoutLog[currentDate].push(entry);
  saveLog();
  renderWorkoutEntries();
  updateDailyStats();
  
  beep(800, 0.1, 0.2);
}

function addSet(entryId, reps, weight = 0) {
  const entry = workoutLog[currentDate].find(e => e.id === entryId);
  if (entry) {
    entry.sets.push({ reps: parseInt(reps), weight: parseFloat(weight) || 0 });
    saveLog();
    renderWorkoutEntries();
    updateDailyStats();
    beep(900, 0.1, 0.2);
  }
}

function removeEntry(entryId) {
  if (workoutLog[currentDate]) {
    workoutLog[currentDate] = workoutLog[currentDate].filter(e => e.id !== entryId);
    saveLog();
    renderWorkoutEntries();
    updateDailyStats();
  }
}

function renderWorkoutEntries() {
  const container = document.getElementById('workoutEntries');
  const entries = workoutLog[currentDate] || [];
  
  container.innerHTML = entries.map(entry => `
    <div class="workout-entry">
      <div>
        <div class="exercise-name">${entry.name}</div>
        <div class="sets-info">${entry.sets.length} sets, ${entry.sets.reduce((sum, s) => sum + s.reps, 0)} total reps</div>
        
        <div class="set-inputs" style="display: none;" id="inputs-${entry.id}">
          <input type="number" placeholder="Reps" id="reps-${entry.id}" min="1">
          <input type="number" placeholder="Weight" id="weight-${entry.id}" min="0" step="0.5">
          <button onclick="addSetFromInputs(${entry.id})">Add</button>
        </div>
        
        <div style="margin-top: 8px;">
          ${entry.sets.map((set, i) => `
            <span style="font-family: var(--font-mono); font-size: 11px; color: var(--text-muted); margin-right: 8px;">
              ${i+1}: ${set.reps}${set.weight > 0 ? ` × ${set.weight}kg` : ''}
            </span>
          `).join('')}
        </div>
      </div>
      
      <div class="entry-actions">
        <button onclick="toggleSetInputs(${entry.id})">Add Set</button>
        <button onclick="removeEntry(${entry.id})" style="color: var(--danger);">Remove</button>
      </div>
    </div>
  `).join('');
}

function toggleSetInputs(entryId) {
  const inputs = document.getElementById(`inputs-${entryId}`);
  inputs.style.display = inputs.style.display === 'none' ? 'grid' : 'none';
  
  if (inputs.style.display === 'grid') {
    document.getElementById(`reps-${entryId}`).focus();
  }
}

function addSetFromInputs(entryId) {
  const reps = document.getElementById(`reps-${entryId}`).value;
  const weight = document.getElementById(`weight-${entryId}`).value;
  
  if (reps) {
    addSet(entryId, reps, weight);
    document.getElementById(`reps-${entryId}`).value = '';
    document.getElementById(`weight-${entryId}`).value = '';
    toggleSetInputs(entryId);
  }
}

function updateDailyStats() {
  const entries = workoutLog[currentDate] || [];
  const totalSets = entries.reduce((sum, e) => sum + e.sets.length, 0);
  const totalReps = entries.reduce((sum, e) => sum + e.sets.reduce((rsum, s) => rsum + s.reps, 0), 0);
  const totalExercises = entries.length;
  
  document.getElementById('totalSets').textContent = totalSets;
  document.getElementById('totalReps').textContent = totalReps;
  document.getElementById('totalExercises').textContent = totalExercises;
}

function exportLog() {
  const entries = workoutLog[currentDate] || [];
  let exportData = `Training Log - ${new Date().toLocaleDateString()}\n`;
  exportData += `${'='.repeat(40)}\n\n`;
  
  entries.forEach(entry => {
    exportData += `${entry.name}\n`;
    entry.sets.forEach((set, i) => {
      exportData += `  Set ${i+1}: ${set.reps} reps${set.weight > 0 ? ` @ ${set.weight}kg` : ''}\n`;
    });
    exportData += `\n`;
  });
  
  const totalSets = entries.reduce((sum, e) => sum + e.sets.length, 0);
  const totalReps = entries.reduce((sum, e) => sum + e.sets.reduce((rsum, s) => rsum + s.reps, 0), 0);
  
  exportData += `Summary:\n`;
  exportData += `- ${entries.length} exercises\n`;
  exportData += `- ${totalSets} total sets\n`;
  exportData += `- ${totalReps} total reps\n`;
  
  const blob = new Blob([exportData], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `training-log-${currentDate}.txt`;
  a.click();
  URL.revokeObjectURL(url);
  
  beep(1000, 0.2, 0.3);
}

function saveLog() {
  localStorage.setItem('workout_log', JSON.stringify(workoutLog));
}

// ═══════════════════════════════════════════
// INIT
// ═══════════════════════════════════════════
updateTimerDisplay();
renderSkillTree();
renderAssessment();
renderLog();
initAudio(); // Initialize audio system with custom sounds
// loadEditData(); // Uncomment to restore previous edits

</script>
</body>
</html>