<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SATURNO FORGE — 3-in-1 Command Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-void: #030303;
            --bg-base: #050505;
            --bg-elevated: #0a0a0a;
            --bg-surface: #111111;
            --border: #1a1a1a;
            --border-hover: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #a1a1aa;
            --text-muted: #52525b;
            --accent-purple: #a855f7;
            --accent-cyan: #06b6d4;
            --accent-green: #22c55e;
            --accent-amber: #f59e0b;
            --accent-red: #ef4444;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-void);
            color: var(--text-secondary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: var(--bg-base); }
        ::-webkit-scrollbar-thumb { background: var(--border-hover); border-radius: 2px; }

        .panel {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: 4px;
            overflow: hidden;
        }

        .panel-header {
            background: var(--bg-surface);
            border-bottom: 1px solid var(--border);
            padding: 12px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .panel-title {
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.2em;
        }

        .panel-body { padding: 16px; }

        textarea, input[type="text"], input[type="password"], select {
            width: 100%;
            background: var(--bg-base);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 10px 12px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 12px;
            resize: none;
            transition: border-color 0.2s;
        }

        textarea:focus, input:focus, select:focus {
            outline: none;
            border-color: var(--accent-purple);
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 4px;
            font-family: inherit;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary { background: var(--accent-purple); color: white; }
        .btn-primary:hover { background: #9333ea; transform: translateY(-1px); }
        .btn-secondary { background: var(--bg-surface); color: var(--text-secondary); border: 1px solid var(--border); }
        .btn-secondary:hover { background: var(--border); color: white; }
        .btn-success { background: var(--accent-green); color: white; }
        .btn-success:hover { background: #16a34a; }
        .btn-cyan { background: var(--accent-cyan); color: white; }
        .btn-cyan:hover { background: #0891b2; }
        .btn-amber { background: var(--accent-amber); color: #000; }
        .btn-amber:hover { background: #d97706; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }

        .variant-card {
            background: var(--bg-base);
            border-left: 3px solid var(--accent-purple);
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 0 4px 4px 0;
        }
        .variant-card.ig { border-color: #e1306c; }
        .variant-card.email { border-color: var(--accent-amber); }
        .variant-card.yt { border-color: #ff0000; }
        .variant-card.twitter { border-color: #1da1f2; }
        .variant-card.linkedin { border-color: #0077b5; }
        .variant-card.tiktok { border-color: #00f2ea; }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 9px;
            font-weight: 500;
            text-transform: uppercase;
        }
        .status-ready { background: rgba(34, 197, 94, 0.1); color: var(--accent-green); }
        .status-working { background: rgba(245, 158, 11, 0.1); color: var(--accent-amber); }
        .status-error { background: rgba(239, 68, 68, 0.1); color: var(--accent-red); }

        .mode-btn {
            padding: 6px 10px;
            font-size: 9px;
            background: var(--bg-base);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
        }
        .mode-btn:hover { border-color: var(--border-hover); color: var(--text-secondary); }
        .mode-btn.active { border-color: var(--accent-purple); color: var(--accent-purple); background: rgba(168, 85, 247, 0.1); }

        .checkbox-custom {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--bg-base);
            border: 1px solid var(--border);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .checkbox-custom:hover { border-color: var(--border-hover); }
        .checkbox-custom.checked { border-color: var(--accent-purple); background: rgba(168, 85, 247, 0.1); }
        .checkbox-custom input { display: none; }

        .pdf-preview {
            background: white;
            color: #1a1a1a;
            font-family: Georgia, serif;
            padding: 30px;
            border-radius: 4px;
            max-height: 400px;
            overflow-y: auto;
        }
        .pdf-preview h1 { font-size: 24px; font-weight: bold; margin-bottom: 8px; }
        .pdf-preview h2 { font-size: 14px; color: #666; font-style: italic; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #1a1a1a; }
        .pdf-preview p { font-size: 14px; line-height: 1.7; margin-bottom: 12px; }
        .pdf-preview .footer { font-size: 11px; color: #888; margin-top: 30px; padding-top: 15px; border-top: 1px solid #ddd; }

        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 100; align-items: center; justify-content: center; }
        .modal.show { display: flex; }
        .modal-content { background: var(--bg-elevated); border: 1px solid var(--border); padding: 24px; max-width: 400px; width: 100%; }

        .spinner { width: 16px; height: 16px; border: 2px solid transparent; border-top-color: currentColor; border-radius: 50%; animation: spin 0.8s linear infinite; display: inline-block; vertical-align: middle; margin-right: 8px; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="flex flex-col h-screen">

    <!-- HEADER -->
    <header class="h-12 border-b border-zinc-900 bg-black flex items-center justify-between px-4 shrink-0">
        <div class="flex items-center gap-4">
            <h1 class="text-white text-sm font-bold tracking-tight">SATURNO FORGE</h1>
            <span class="text-[9px] text-zinc-600 uppercase tracking-widest">3-in-1 Command Center</span>
        </div>
        <div class="flex items-center gap-3">
            <span id="global-status" class="status-badge status-ready"><span class="w-1.5 h-1.5 rounded-full bg-current"></span>READY</span>
            <button onclick="openApiModal()" class="btn btn-secondary text-[9px]" id="api-btn">API KEY</button>
        </div>
    </header>

    <!-- MAIN 3-PANEL LAYOUT -->
    <main class="flex-grow flex gap-4 p-4 overflow-hidden">

        <!-- PANEL 1: PDF MAKER -->
        <section class="panel flex-1 flex flex-col min-w-0">
            <div class="panel-header">
                <span class="panel-title text-purple-400">01 / PDF MAKER</span>
            </div>
            <div class="panel-body flex-grow flex flex-col gap-4 overflow-y-auto">
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-1">Title</label>
                        <input type="text" id="pdf-title" value="Movement Framework" placeholder="Document title">
                    </div>
                    <div>
                        <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-1">Author</label>
                        <input type="text" id="pdf-author" value="Gabo Saturno" placeholder="Author name">
                    </div>
                </div>

                <div>
                    <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-2">Template</label>
                    <div class="flex gap-2">
                        <button class="mode-btn active" data-template="professional">Professional</button>
                        <button class="mode-btn" data-template="creative">Creative</button>
                        <button class="mode-btn" data-template="minimal">Minimal</button>
                        <button class="mode-btn" data-template="dark">Dark</button>
                    </div>
                </div>

                <div class="flex-grow flex flex-col">
                    <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-1">Content</label>
                    <textarea id="pdf-content" class="flex-grow min-h-[150px]" placeholder="Paste content here...

# Heading
## Subheading
- Bullet points
**Bold text**"></textarea>
                </div>

                <div id="pdf-preview-container" class="hidden">
                    <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-1">Preview</label>
                    <div id="pdf-preview" class="pdf-preview"></div>
                </div>

                <div class="flex gap-2">
                    <button onclick="generatePDFPreview()" class="btn btn-secondary flex-1">Preview</button>
                    <button onclick="downloadPDF()" class="btn btn-primary flex-1">Download PDF</button>
                </div>
            </div>
        </section>

        <!-- PANEL 2: CAPTION MULTIPLIER -->
        <section class="panel flex-1 flex flex-col min-w-0">
            <div class="panel-header">
                <span class="panel-title text-cyan-400">02 / CAPTION MULTIPLIER</span>
                <span class="text-[9px] text-zinc-600">CLAUDE API</span>
            </div>
            <div class="panel-body flex-grow flex flex-col gap-4 overflow-y-auto">
                <div>
                    <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-1">Seed Phrase</label>
                    <textarea id="seed-input" rows="4" placeholder="Enter your core idea...

Example: 'Mastery isn't about perfection. It's about showing up before you're ready.'"></textarea>
                </div>

                <div>
                    <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-2">Voice Mode</label>
                    <div class="flex flex-wrap gap-2" id="voice-modes">
                        <button class="mode-btn" data-mode="Raw">Raw</button>
                        <button class="mode-btn active" data-mode="Teacher">Teacher</button>
                        <button class="mode-btn" data-mode="Prophet">Prophet</button>
                        <button class="mode-btn" data-mode="Rebel">Rebel</button>
                        <button class="mode-btn" data-mode="Mystic">Mystic</button>
                    </div>
                </div>

                <div>
                    <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-2">Platforms</label>
                    <div class="grid grid-cols-3 gap-2">
                        <label class="checkbox-custom checked"><input type="checkbox" data-platform="ig" checked><span class="text-[10px]">Instagram</span></label>
                        <label class="checkbox-custom checked"><input type="checkbox" data-platform="email" checked><span class="text-[10px]">Email</span></label>
                        <label class="checkbox-custom checked"><input type="checkbox" data-platform="yt" checked><span class="text-[10px]">YouTube</span></label>
                        <label class="checkbox-custom"><input type="checkbox" data-platform="twitter"><span class="text-[10px]">Twitter/X</span></label>
                        <label class="checkbox-custom"><input type="checkbox" data-platform="linkedin"><span class="text-[10px]">LinkedIn</span></label>
                        <label class="checkbox-custom"><input type="checkbox" data-platform="tiktok"><span class="text-[10px]">TikTok</span></label>
                    </div>
                </div>

                <button onclick="multiplyCaption()" class="btn btn-cyan w-full" id="multiply-btn">Multiply with Claude AI</button>

                <div id="variants-container" class="flex-grow overflow-y-auto space-y-2">
                    <div class="text-center text-zinc-600 text-[11px] py-8">
                        Enter seed + click Multiply to generate variants
                    </div>
                </div>
            </div>
        </section>

        <!-- PANEL 3: QUICK DEPLOY -->
        <section class="panel w-72 flex flex-col shrink-0">
            <div class="panel-header">
                <span class="panel-title text-green-400">03 / QUICK DEPLOY</span>
            </div>
            <div class="panel-body flex flex-col gap-4">
                <div>
                    <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-1">Project</label>
                    <input type="text" id="project-name" value="titan-forge">
                </div>

                <div class="border-t border-zinc-800 pt-4">
                    <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-2">GitHub</label>
                    <div class="space-y-2">
                        <input type="text" id="github-repo" value="gabosaturno11/titan-forge">
                        <button onclick="copyGitCommands()" class="btn btn-secondary w-full">Copy Git Commands</button>
                    </div>
                </div>

                <div class="border-t border-zinc-800 pt-4">
                    <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-2">Vercel</label>
                    <div class="space-y-2">
                        <button onclick="openVercel()" class="btn btn-success w-full">Open Vercel Dashboard</button>
                    </div>
                </div>

                <div class="border-t border-zinc-800 pt-4">
                    <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-2">Export</label>
                    <div class="space-y-2">
                        <button onclick="copyAllVariants()" class="btn btn-secondary w-full">Copy All Variants</button>
                    </div>
                </div>

                <div class="border-t border-zinc-800 pt-4 flex-grow">
                    <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-2">Log</label>
                    <div id="deploy-log" class="bg-zinc-900/50 rounded p-3 text-[10px] text-zinc-500 h-32 overflow-y-auto font-mono"></div>
                </div>
            </div>
        </section>

    </main>

    <!-- FOOTER -->
    <footer class="h-8 border-t border-zinc-900 bg-black flex items-center justify-between px-4 text-[9px] shrink-0">
        <span class="text-zinc-600">SATURNO FORGE V2.0 — Direct Claude API</span>
        <span class="text-zinc-700">Ctrl+S: PDF | Ctrl+M: Multiply</span>
    </footer>

    <!-- API KEY MODAL -->
    <div id="api-modal" class="modal">
        <div class="modal-content">
            <h2 class="text-white font-bold mb-4">Claude API Key</h2>
            <div class="space-y-4">
                <div>
                    <label class="text-[9px] text-zinc-500 uppercase tracking-wider block mb-1">API Key</label>
                    <input type="password" id="api-key-input" placeholder="sk-ant-api03-..." class="w-full">
                    <p class="text-[9px] text-zinc-600 mt-2">Get key from console.anthropic.com</p>
                </div>
            </div>
            <div class="flex gap-2 mt-6">
                <button onclick="saveApiKey()" class="btn btn-amber flex-1">Save</button>
                <button onclick="closeApiModal()" class="btn btn-secondary flex-1">Cancel</button>
            </div>
            <div id="api-msg" class="text-[10px] mt-4 hidden"></div>
        </div>
    </div>

    <script>
        // ═══════════════════════════════════════════════════════════════════════
        // STATE
        // ═══════════════════════════════════════════════════════════════════════
        const STORAGE_KEY = 'claude_api_key';
        let currentVoiceMode = 'Teacher';
        let generatedVariants = [];

        // ═══════════════════════════════════════════════════════════════════════
        // API KEY MANAGEMENT
        // ═══════════════════════════════════════════════════════════════════════
        function getApiKey() { return localStorage.getItem(STORAGE_KEY); }
        function hasApiKey() { return !!getApiKey(); }

        function openApiModal() {
            document.getElementById('api-modal').classList.add('show');
            document.getElementById('api-key-input').value = '';
            document.getElementById('api-key-input').placeholder = hasApiKey() ? 'Key saved (enter new to replace)' : 'sk-ant-api03-...';
        }

        function closeApiModal() {
            document.getElementById('api-modal').classList.remove('show');
        }

        function saveApiKey() {
            const key = document.getElementById('api-key-input').value.trim();
            const msg = document.getElementById('api-msg');

            if (key) {
                localStorage.setItem(STORAGE_KEY, key);
                msg.className = 'text-[10px] mt-4 text-green-500';
                msg.textContent = 'Saved!';
                msg.classList.remove('hidden');
                updateApiButton();
                log('API key saved');
                setTimeout(closeApiModal, 600);
            } else if (hasApiKey()) {
                closeApiModal();
            } else {
                msg.className = 'text-[10px] mt-4 text-red-500';
                msg.textContent = 'Please enter a key';
                msg.classList.remove('hidden');
            }
        }

        function updateApiButton() {
            const btn = document.getElementById('api-btn');
            if (hasApiKey()) {
                btn.textContent = 'API OK';
                btn.classList.remove('btn-secondary');
                btn.classList.add('btn-success');
            } else {
                btn.textContent = 'API KEY';
                btn.classList.remove('btn-success');
                btn.classList.add('btn-secondary');
            }
        }

        // ═══════════════════════════════════════════════════════════════════════
        // DIRECT CLAUDE API CALL
        // ═══════════════════════════════════════════════════════════════════════
        async function callClaude(prompt) {
            const apiKey = getApiKey();
            if (!apiKey) throw new Error('No API key');

            const response = await fetch('https://api.anthropic.com/v1/messages', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'x-api-key': apiKey,
                    'anthropic-version': '2023-06-01',
                    'anthropic-dangerous-direct-browser-access': 'true'
                },
                body: JSON.stringify({
                    model: 'claude-sonnet-4-20250514',
                    max_tokens: 2000,
                    messages: [{ role: 'user', content: prompt }]
                })
            });

            if (!response.ok) {
                const err = await response.json().catch(() => ({}));
                throw new Error(err.error?.message || `API error ${response.status}`);
            }

            const data = await response.json();
            return data.content?.[0]?.text || '';
        }

        // ═══════════════════════════════════════════════════════════════════════
        // UI EVENT HANDLERS
        // ═══════════════════════════════════════════════════════════════════════
        document.querySelectorAll('[data-template]').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('[data-template]').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                log('Template: ' + this.dataset.template);
            });
        });

        document.querySelectorAll('[data-mode]').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('[data-mode]').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentVoiceMode = this.dataset.mode;
                log('Voice: ' + currentVoiceMode);
            });
        });

        document.querySelectorAll('.checkbox-custom').forEach(label => {
            label.addEventListener('click', function(e) {
                if (e.target.tagName !== 'INPUT') {
                    const cb = this.querySelector('input');
                    cb.checked = !cb.checked;
                }
                this.classList.toggle('checked', this.querySelector('input').checked);
            });
        });

        // ═══════════════════════════════════════════════════════════════════════
        // PDF MAKER
        // ═══════════════════════════════════════════════════════════════════════
        function generatePDFPreview() {
            const title = document.getElementById('pdf-title').value || 'Untitled';
            const author = document.getElementById('pdf-author').value || 'Gabo Saturno';
            const content = document.getElementById('pdf-content').value;

            if (!content.trim()) { alert('Enter content first'); return; }

            let html = content
                .replace(/^# (.*$)/gm, '<h1 style="font-size:20px;font-weight:bold;margin-top:20px;">$1</h1>')
                .replace(/^## (.*$)/gm, '<h3 style="font-size:16px;font-weight:bold;margin-top:15px;">$1</h3>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/^- (.*$)/gm, '<li style="margin-left:20px;">$1</li>')
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>');

            document.getElementById('pdf-preview').innerHTML = `
                <h1>${title}</h1>
                <h2>By ${author}</h2>
                <div style="margin-top:20px;">${html}</div>
                <div class="footer">SATURNO MOVEMENT | saturnomovement.com</div>
            `;
            document.getElementById('pdf-preview-container').classList.remove('hidden');
            log('Preview generated');
        }

        function downloadPDF() {
            const preview = document.getElementById('pdf-preview');
            const title = document.getElementById('pdf-title').value || 'document';
            if (!preview.innerHTML) generatePDFPreview();

            setStatus('GENERATING...', 'working');
            html2pdf().set({
                margin: 15,
                filename: `${title.replace(/\s+/g, '_')}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            }).from(preview).save().then(() => {
                log('PDF downloaded');
                setStatus('DONE', 'ready');
            });
        }

        // ═══════════════════════════════════════════════════════════════════════
        // CAPTION MULTIPLIER
        // ═══════════════════════════════════════════════════════════════════════
        async function multiplyCaption() {
            const seed = document.getElementById('seed-input').value.trim();
            if (!seed) { alert('Enter a seed phrase'); return; }
            if (!hasApiKey()) { openApiModal(); return; }

            const platforms = [];
            document.querySelectorAll('[data-platform]:checked').forEach(cb => platforms.push(cb.dataset.platform));
            if (!platforms.length) { alert('Select at least one platform'); return; }

            const btn = document.getElementById('multiply-btn');
            btn.disabled = true;
            btn.innerHTML = '<span class="spinner"></span>Generating...';
            setStatus('CALLING CLAUDE...', 'working');
            log('Starting generation...');

            generatedVariants = [];

            const platformGuides = {
                ig: 'Instagram caption (2000 chars max). Line breaks for readability. End with #SaturnoMovement and 3-4 hashtags.',
                email: 'Email newsletter. Start with engaging subject line on first line. Personal, conversational. End with call to reply.',
                yt: 'YouTube script with [HOOK - 0:00], [EXPAND - 0:30], [CTA - End] sections.',
                twitter: 'Twitter/X post (280 chars max). Punchy and direct.',
                linkedin: 'LinkedIn post. Professional but personal. End with engagement question.',
                tiktok: 'TikTok script with [TEXT ON SCREEN] and [VOICEOVER] sections. Keep it punchy.'
            };

            const platformNames = {
                ig: 'Instagram', email: 'Email', yt: 'YouTube',
                twitter: 'Twitter/X', linkedin: 'LinkedIn', tiktok: 'TikTok'
            };

            try {
                for (const platform of platforms) {
                    log(`Generating ${platformNames[platform]}...`);

                    const prompt = `You are writing as Gabo Saturno, a calisthenics coach and movement philosopher.

VOICE MODE: ${currentVoiceMode}
- Raw: Direct, unfiltered, stream of consciousness
- Teacher: Educational, clear explanations with examples
- Prophet: Visionary, inspiring, speaks of transformation
- Rebel: Challenges norms, provocative, punk energy
- Mystic: Poetic, metaphorical, spiritual depth

SEED CONTENT:
${seed}

TASK: Transform this into a ${platformNames[platform]} post.
FORMAT: ${platformGuides[platform]}

Output ONLY the final content. No explanations or meta-commentary.`;

                    const result = await callClaude(prompt);

                    generatedVariants.push({
                        id: `v${generatedVariants.length}`,
                        platform,
                        platformName: platformNames[platform],
                        content: result
                    });

                    // Rate limit
                    if (platforms.indexOf(platform) < platforms.length - 1) {
                        await new Promise(r => setTimeout(r, 800));
                    }
                }

                renderVariants();
                log(`Generated ${generatedVariants.length} variants`);
                setStatus(`${generatedVariants.length} READY`, 'ready');

            } catch (err) {
                log('ERROR: ' + err.message);
                setStatus('ERROR', 'error');
                alert('Error: ' + err.message);
            } finally {
                btn.disabled = false;
                btn.textContent = 'Multiply with Claude AI';
            }
        }

        function renderVariants() {
            const container = document.getElementById('variants-container');
            container.innerHTML = generatedVariants.map(v => `
                <div class="variant-card ${v.platform}">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-[9px] uppercase tracking-wider text-zinc-500">${v.platformName}</span>
                        <button onclick="copyVariant('${v.id}')" class="text-[9px] text-purple-400 hover:text-purple-300">Copy</button>
                    </div>
                    <p class="text-[11px] text-zinc-300 leading-relaxed whitespace-pre-wrap" id="variant-${v.id}">${escapeHtml(v.content)}</p>
                </div>
            `).join('');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function copyVariant(id) {
            const el = document.getElementById(`variant-${id}`);
            if (el) {
                navigator.clipboard.writeText(el.innerText);
                log('Copied');
            }
        }

        function copyAllVariants() {
            if (!generatedVariants.length) { alert('Generate variants first'); return; }
            const text = generatedVariants.map(v => `=== ${v.platformName} ===\n${v.content}`).join('\n\n---\n\n');
            navigator.clipboard.writeText(text);
            log('All copied');
            alert('All variants copied!');
        }

        // ═══════════════════════════════════════════════════════════════════════
        // DEPLOY HELPERS
        // ═══════════════════════════════════════════════════════════════════════
        function copyGitCommands() {
            const project = document.getElementById('project-name').value;
            navigator.clipboard.writeText(`git add . && git commit -m "Update ${project}" && git push origin main`);
            log('Git commands copied');
            alert('Copied!');
        }

        function openVercel() {
            window.open('https://vercel.com/dashboard', '_blank');
            log('Opened Vercel');
        }

        // ═══════════════════════════════════════════════════════════════════════
        // UTILITIES
        // ═══════════════════════════════════════════════════════════════════════
        function log(msg) {
            const el = document.getElementById('deploy-log');
            const time = new Date().toLocaleTimeString('en-US', { hour12: false });
            el.innerHTML += `<div>> [${time}] ${msg}</div>`;
            el.scrollTop = el.scrollHeight;
        }

        function setStatus(text, type) {
            const el = document.getElementById('global-status');
            el.innerHTML = `<span class="w-1.5 h-1.5 rounded-full bg-current"></span>${text}`;
            el.className = `status-badge status-${type}`;
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                if (e.key === 's') { e.preventDefault(); downloadPDF(); }
                if (e.key === 'm') { e.preventDefault(); multiplyCaption(); }
            }
        });

        // Init
        updateApiButton();
        log('FORGE initialized');
        log(hasApiKey() ? 'API key found' : 'No API key - click API KEY button');
    </script>

</body>
</html>
